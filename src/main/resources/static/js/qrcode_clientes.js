$(function(){function a(n){m=$.ajax({method:'GET',url:'/qrcode/clientes/buscar',data:{nome:n.trim()}}).done(function(o){var p=!0;$('#tb-clientes>tbody>tr').remove(),o.length?(f.fadeOut('fast'),g.fadeIn('fast'),$.each(o,function(q,r){var s='';b(r.id)?s='checked="checked"':p=!1;var t='<tr>';t+='<td style="width: 5%;"><input data-id="'+r.id+'" data="'+r.id+':'+r.nome+'" id="'+r.id+'_cb" type="checkbox" class="filled-in js-cb-gerar" id="filled-in-box" '+s+'/> <label for="'+r.id+'_cb"></label></td>',t+='<td style="width: 35%;">'+r.nome+'</td>',t+='<td style="width: 25%;">'+r.telefone1+'</td>',t+='<td style="width: 25%;">'+(r.cpf?r.cpf:r.cnpj)+'</td>',t+='<td style="text-align: right;">',t+='<span class="new badge '+(r.ativo?'green':'red')+'" data-badge-caption="">'+(r.ativo?'ATIVO':'INATIVO')+'</span></td>',t+='</tr>',g.find('tbody').append(t)}),$('.js-cb-gerar').on('change',function(){var q=$(this).attr('data-id'),r=$(this).is(':checked');c(q,r),d(),$('.js-cb-gerar').length<=$('.js-cb-gerar:checked').length?$('.js-cb-gerar-all').prop('checked','checked'):$('.js-cb-gerar-all').prop('checked','')}),!p&&h.prop('checked','')):($('.js-filter-expression').text(n.trim()),g.fadeOut('fast'),f.fadeIn('fast'))}).fail(function(o,p){console.log(p)})}function b(n){return 0<=l.indexOf(n)}function c(n,o){var p=l.indexOf(parseInt(n));o?0>p&&l.push(parseInt(n)):0<=p&&l.splice(parseInt(p),1)}function d(){var n=$('.js-cb-gerar:checked');0<n.length?n.each(function(){j.hasClass('scale-in')||j.addClass('scale-in')}):j.removeClass('scale-in')}var e=$('#search'),f=$('.js-no-records-found'),g=$('#tb-clientes'),h=$('.js-cb-gerar-all'),j=$('.js-btn-gerar'),k=-1,l=[],m;e.keyup(function(){var n=e.val();0==n.length&&0==k||((0==n.length||2<n.length)&&(!!m&&m.abort(),a(n)),k=n)}),a(''),$('.js-cb-gerar-all').on('change',function(){$(this).is(':checked')?$('.js-cb-gerar').prop('checked','checked'):$('.js-cb-gerar').prop('checked',''),$('.js-cb-gerar').each(function(){c($(this).attr('data-id'),$(this).is(':checked'))}),d()}),$('.js-btn-gerar').on('click',function(){var n='';$('.js-cb-gerar:checked').each(function(o,p){n+=$(p).attr('data')+','}),$('.js-hidden-records').val(n.substring(0,n.length-1).trim()),$('.js-form-gerar').submit()})});